<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevSecScan - Security Scanning Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .gradient-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .score-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 800;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .score-A { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .score-B { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        .score-C { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .score-D { background: linear-gradient(135deg, #f97316 0%, #ea580c 100%); }
        .score-F { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        
        .pulse-dot {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .scan-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        
        .scan-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .feature-card {
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }
        
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .nav-tab {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid transparent;
        }

        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .nav-tab.active {
            background: white;
            color: #667eea;
            border-color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-shield-alt text-4xl"></i>
                    <div>
                        <h1 class="text-3xl font-bold">DevSecScan</h1>
                        <p class="text-purple-200 text-sm">Comprehensive Security Scanning Platform</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="pulse-dot w-3 h-3 bg-green-400 rounded-full"></div>
                        <span class="text-sm">API Online</span>
                    </div>
                    <a href="http://localhost:8000/docs" target="_blank" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg text-sm transition">
                        <i class="fas fa-book mr-2"></i>API Docs
                    </a>
                </div>
            </div>

            <!-- Navigation Tabs -->
            <div class="mt-6 flex space-x-2 overflow-x-auto">
                <button onclick="showTab('security-scan')" class="nav-tab active px-6 py-3 rounded-lg font-semibold transition">
                    <i class="fas fa-shield-alt mr-2"></i>Security Scan
                </button>
                <button onclick="showTab('phishing-detection')" class="nav-tab px-6 py-3 rounded-lg font-semibold transition">
                    <i class="fas fa-fish mr-2"></i>Phishing Detection
                </button>
                <button onclick="showTab('email-analysis')" class="nav-tab px-6 py-3 rounded-lg font-semibold transition">
                    <i class="fas fa-envelope mr-2"></i>Email Analysis
                </button>
                <button onclick="showTab('ml-insights')" class="nav-tab px-6 py-3 rounded-lg font-semibold transition">
                    <i class="fas fa-brain mr-2"></i>ML Insights
                </button>
                <button onclick="showTab('browser-extension')" class="nav-tab px-6 py-3 rounded-lg font-semibold transition">
                    <i class="fas fa-puzzle-piece mr-2"></i>Browser Extension
                </button>
                <button onclick="showTab('monitoring')" class="nav-tab px-6 py-3 rounded-lg font-semibold transition">
                    <i class="fas fa-chart-line mr-2"></i>Monitoring
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container mx-auto px-6 py-8">

        <!-- TAB 1: Security Scan -->
        <div id="security-scan-tab" class="tab-content active">
        <!-- Quick Scan Section -->
        <div class="glass-card rounded-2xl p-8 mb-8">
            <div class="text-center mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">
                    <i class="fas fa-search text-purple-600 mr-3"></i>Security Scan
                </h2>
                <p class="text-gray-600">Enter a URL to perform comprehensive security analysis</p>
            </div>
            
            <div class="max-w-3xl mx-auto">
                <div class="flex gap-4">
                    <input 
                        type="text" 
                        id="scan-url" 
                        placeholder="https://example.com" 
                        class="flex-1 px-6 py-4 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none text-lg"
                    >
                    <button onclick="runComprehensiveScan()" class="scan-button text-white px-8 py-4 rounded-xl font-semibold text-lg">
                        <i class="fas fa-bolt mr-2"></i>Scan Now
                    </button>
                </div>
                
                <!-- Scan Type Selector -->
                <div class="mt-4 flex gap-3 justify-center">
                    <button onclick="setScanType('comprehensive', event)" class="scan-type-btn active px-4 py-2 rounded-lg text-sm font-medium bg-purple-600 text-white">
                        <i class="fas fa-shield-alt mr-1"></i>Comprehensive
                    </button>
                    <button onclick="setScanType('quick', event)" class="scan-type-btn px-4 py-2 rounded-lg text-sm font-medium bg-gray-200 text-gray-700">
                        <i class="fas fa-bolt mr-1"></i>Quick Scan
                    </button>
                    <button onclick="setScanType('ssl', event)" class="scan-type-btn px-4 py-2 rounded-lg text-sm font-medium bg-gray-200 text-gray-700">
                        <i class="fas fa-lock mr-1"></i>SSL Only
                    </button>
                    <button onclick="setScanType('phishing', event)" class="scan-type-btn px-4 py-2 rounded-lg text-sm font-medium bg-gray-200 text-gray-700">
                        <i class="fas fa-fish mr-1"></i>Phishing Only
                    </button>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results-section" class="hidden">
            <!-- Overall Score Card -->
            <div class="glass-card rounded-2xl p-8 mb-8">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Score Circle -->
                    <div class="flex flex-col items-center justify-center">
                        <div id="score-circle" class="score-circle score-A mb-4">
                            <span id="overall-score">85</span>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-gray-800" id="grade-text">Grade: A</div>
                            <div class="text-gray-600" id="security-level">Good Security</div>
                        </div>
                    </div>
                    
                    <!-- Scanner Scores -->
                    <div class="lg:col-span-2">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Scanner Results</h3>
                        <div class="space-y-4">
                            <div class="scanner-result">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-semibold text-gray-700">
                                        <i class="fas fa-lock text-blue-500 mr-2"></i>SSL/TLS Security
                                    </span>
                                    <span id="ssl-score" class="text-lg font-bold text-blue-600">90/100</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div id="ssl-bar" class="bg-blue-500 h-3 rounded-full" style="width: 90%"></div>
                                </div>
                            </div>
                            
                            <div class="scanner-result">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-semibold text-gray-700">
                                        <i class="fas fa-shield-alt text-green-500 mr-2"></i>Security Headers
                                    </span>
                                    <span id="headers-score" class="text-lg font-bold text-green-600">75/100</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div id="headers-bar" class="bg-green-500 h-3 rounded-full" style="width: 75%"></div>
                                </div>
                            </div>
                            
                            <div class="scanner-result">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-semibold text-gray-700">
                                        <i class="fas fa-bug text-purple-500 mr-2"></i>Vulnerabilities
                                    </span>
                                    <span id="vuln-score" class="text-lg font-bold text-purple-600">95/100</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div id="vuln-bar" class="bg-purple-500 h-3 rounded-full" style="width: 95%"></div>
                                </div>
                            </div>
                            
                            <div class="scanner-result">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-semibold text-gray-700">
                                        <i class="fas fa-fish text-orange-500 mr-2"></i>Phishing Detection
                                    </span>
                                    <span id="phishing-score" class="text-lg font-bold text-orange-600">80/100</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div id="phishing-bar" class="bg-orange-500 h-3 rounded-full" style="width: 80%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Issues & Recommendations -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Issues Found -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>Issues Found
                    </h3>
                    <div id="issues-list" class="space-y-3">
                        <!-- Dynamic content -->
                    </div>
                </div>
                
                <!-- Recommendations -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-lightbulb text-blue-500 mr-2"></i>Top Recommendations
                    </h3>
                    <div id="recommendations-list" class="space-y-3">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="feature-card glass-card rounded-xl p-6 text-center">
                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-lock text-blue-600 text-2xl"></i>
                </div>
                <h3 class="font-bold text-gray-800 mb-2">SSL/TLS Analysis</h3>
                <p class="text-sm text-gray-600">Certificate validation & encryption strength</p>
            </div>
            
            <div class="feature-card glass-card rounded-xl p-6 text-center">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-shield-alt text-green-600 text-2xl"></i>
                </div>
                <h3 class="font-bold text-gray-800 mb-2">Security Headers</h3>
                <p class="text-sm text-gray-600">CSP, HSTS, X-Frame-Options analysis</p>
            </div>
            
            <div class="feature-card glass-card rounded-xl p-6 text-center">
                <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-bug text-purple-600 text-2xl"></i>
                </div>
                <h3 class="font-bold text-gray-800 mb-2">Vulnerability Scan</h3>
                <p class="text-sm text-gray-600">XSS, SQLi, mixed content detection</p>
            </div>
            
            <div class="feature-card glass-card rounded-xl p-6 text-center">
                <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-fish text-orange-600 text-2xl"></i>
                </div>
                <h3 class="font-bold text-gray-800 mb-2">Phishing Detection</h3>
                <p class="text-sm text-gray-600">ML-based URL & email analysis</p>
            </div>
        </div>

        <!-- Quick Test Samples -->
        <div class="glass-card rounded-2xl p-8">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">
                <i class="fas fa-flask text-purple-600 mr-2"></i>Quick Test Samples
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="testSample('https://www.google.com')" class="text-left p-4 border-2 border-green-200 bg-green-50 rounded-xl hover:shadow-lg transition">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="font-semibold text-gray-800">Google.com</div>
                            <div class="text-sm text-gray-600">Expected: Legitimate, High Score</div>
                        </div>
                        <i class="fas fa-check-circle text-green-500 text-2xl"></i>
                    </div>
                </button>
                
                <button onclick="testSample('https://github.com')" class="text-left p-4 border-2 border-green-200 bg-green-50 rounded-xl hover:shadow-lg transition">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="font-semibold text-gray-800">GitHub.com</div>
                            <div class="text-sm text-gray-600">Expected: Legitimate, High Score</div>
                        </div>
                        <i class="fas fa-check-circle text-green-500 text-2xl"></i>
                    </div>
                </button>
            </div>
        </div>
        </div>
        <!-- END TAB 1: Security Scan -->

        <!-- TAB 2: Phishing Detection -->
        <div id="phishing-detection-tab" class="tab-content">
            <div class="glass-card rounded-2xl p-8 mb-8">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">
                        <i class="fas fa-fish text-orange-600 mr-3"></i>Phishing URL Detection
                    </h2>
                    <p class="text-gray-600">ML-based phishing detection with explainable AI</p>
                </div>

                <div class="max-w-3xl mx-auto">
                    <div class="flex gap-4">
                        <input
                            type="text"
                            id="phishing-url"
                            placeholder="https://example.com"
                            class="flex-1 px-6 py-4 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:outline-none text-lg"
                        >
                        <button onclick="detectPhishing()" class="bg-gradient-to-r from-orange-500 to-red-500 text-white px-8 py-4 rounded-xl font-semibold text-lg hover:shadow-lg transition">
                            <i class="fas fa-search mr-2"></i>Detect
                        </button>
                    </div>

                    <div class="mt-4 flex gap-3 justify-center">
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="show-explanation" checked class="w-4 h-4">
                            <span class="text-sm font-medium text-gray-700">Show AI Explanation</span>
                        </label>
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="show-features" class="w-4 h-4">
                            <span class="text-sm font-medium text-gray-700">Show Features</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Phishing Results -->
            <div id="phishing-results" class="hidden">
                <div class="glass-card rounded-2xl p-8 mb-8">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="text-center">
                            <div id="phishing-verdict" class="text-6xl mb-4">üé£</div>
                            <div id="phishing-label" class="text-3xl font-bold mb-2">Phishing Detected</div>
                            <div id="phishing-confidence" class="text-xl text-gray-600">Confidence: 95%</div>
                            <div id="phishing-threat" class="mt-4 px-4 py-2 rounded-lg inline-block">High Threat</div>
                        </div>

                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-4">
                                <i class="fas fa-brain text-purple-600 mr-2"></i>AI Explanation
                            </h3>
                            <div id="ai-explanation" class="space-y-3">
                                <!-- Dynamic content -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Feature Importance -->
                <div id="feature-importance-section" class="hidden glass-card rounded-2xl p-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-chart-bar text-blue-600 mr-2"></i>Feature Analysis
                    </h3>
                    <div id="feature-importance-chart"></div>
                </div>
            </div>
        </div>
        <!-- END TAB 2: Phishing Detection -->

        <!-- TAB 3: Email Analysis -->
        <div id="email-analysis-tab" class="tab-content">
            <div class="glass-card rounded-2xl p-8">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">
                        <i class="fas fa-envelope text-blue-600 mr-3"></i>Email Phishing Analysis
                    </h2>
                    <p class="text-gray-600">Analyze email content for phishing indicators</p>
                </div>

                <div class="max-w-4xl mx-auto">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <input
                            type="email"
                            id="email-sender"
                            placeholder="sender@example.com (optional)"
                            class="px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none"
                        >
                        <input
                            type="text"
                            id="email-subject"
                            placeholder="Email subject (optional)"
                            class="px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none"
                        >
                    </div>

                    <textarea
                        id="email-content"
                        rows="10"
                        placeholder="Paste email content here..."
                        class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none mb-4"
                    ></textarea>

                    <button onclick="analyzeEmail()" class="w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white px-8 py-4 rounded-xl font-semibold text-lg hover:shadow-lg transition">
                        <i class="fas fa-search mr-2"></i>Analyze Email
                    </button>
                </div>
            </div>

            <!-- Email Results -->
            <div id="email-results" class="hidden mt-8">
                <div class="glass-card rounded-2xl p-8">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="text-center">
                            <div id="email-verdict" class="text-6xl mb-4">üìß</div>
                            <div id="email-label" class="text-3xl font-bold mb-2">Analysis Result</div>
                            <div id="email-confidence" class="text-xl text-gray-600">Confidence: 0%</div>
                        </div>

                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Risk Factors</h3>
                            <div id="email-risk-factors" class="space-y-2">
                                <!-- Dynamic content -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END TAB 3: Email Analysis -->

        <!-- TAB 4: ML Insights -->
        <div id="ml-insights-tab" class="tab-content">
            <div class="glass-card rounded-2xl p-8 mb-8">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">
                        <i class="fas fa-brain text-purple-600 mr-3"></i>Machine Learning Insights
                    </h2>
                    <p class="text-gray-600">Explainable AI & Model Performance</p>
                </div>
            </div>

            <!-- Model Performance -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <div class="glass-card rounded-xl p-6 text-center">
                    <div class="text-4xl font-bold text-purple-600 mb-2">85.9%</div>
                    <div class="text-gray-600">F1-Score</div>
                </div>
                <div class="glass-card rounded-xl p-6 text-center">
                    <div class="text-4xl font-bold text-blue-600 mb-2">16</div>
                    <div class="text-gray-600">Features</div>
                </div>
                <div class="glass-card rounded-xl p-6 text-center">
                    <div class="text-4xl font-bold text-green-600 mb-2">Gradient Boosting</div>
                    <div class="text-gray-600">Algorithm</div>
                </div>
            </div>

            <!-- Feature Importance -->
            <div class="glass-card rounded-2xl p-8 mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-6">
                    <i class="fas fa-chart-bar text-blue-600 mr-2"></i>Global Feature Importance
                </h3>
                <div id="global-feature-importance">
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <div class="w-48 text-sm font-medium text-gray-700">URL Length</div>
                            <div class="flex-1 bg-gray-200 rounded-full h-6 mx-4">
                                <div class="bg-blue-500 h-6 rounded-full" style="width: 85%"></div>
                            </div>
                            <div class="w-16 text-right text-sm font-semibold">0.85</div>
                        </div>
                        <div class="flex items-center">
                            <div class="w-48 text-sm font-medium text-gray-700">Special Characters</div>
                            <div class="flex-1 bg-gray-200 rounded-full h-6 mx-4">
                                <div class="bg-blue-500 h-6 rounded-full" style="width: 72%"></div>
                            </div>
                            <div class="w-16 text-right text-sm font-semibold">0.72</div>
                        </div>
                        <div class="flex items-center">
                            <div class="w-48 text-sm font-medium text-gray-700">Domain Age</div>
                            <div class="flex-1 bg-gray-200 rounded-full h-6 mx-4">
                                <div class="bg-blue-500 h-6 rounded-full" style="width: 68%"></div>
                            </div>
                            <div class="w-16 text-right text-sm font-semibold">0.68</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Model Comparison -->
            <div class="glass-card rounded-2xl p-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-6">
                    <i class="fas fa-trophy text-yellow-500 mr-2"></i>Model Comparison
                </h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Model</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Accuracy</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Precision</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Recall</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">F1-Score</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr class="bg-green-50">
                                <td class="px-6 py-4 font-semibold text-green-800">Gradient Boosting ‚≠ê</td>
                                <td class="px-6 py-4">87.2%</td>
                                <td class="px-6 py-4">86.5%</td>
                                <td class="px-6 py-4">85.3%</td>
                                <td class="px-6 py-4 font-bold">85.9%</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium">Random Forest</td>
                                <td class="px-6 py-4">84.1%</td>
                                <td class="px-6 py-4">83.2%</td>
                                <td class="px-6 py-4">82.8%</td>
                                <td class="px-6 py-4">83.0%</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium">XGBoost</td>
                                <td class="px-6 py-4">85.3%</td>
                                <td class="px-6 py-4">84.7%</td>
                                <td class="px-6 py-4">83.9%</td>
                                <td class="px-6 py-4">84.3%</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium">Logistic Regression</td>
                                <td class="px-6 py-4">78.5%</td>
                                <td class="px-6 py-4">77.2%</td>
                                <td class="px-6 py-4">76.8%</td>
                                <td class="px-6 py-4">77.0%</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium">SVM</td>
                                <td class="px-6 py-4">80.2%</td>
                                <td class="px-6 py-4">79.5%</td>
                                <td class="px-6 py-4">78.9%</td>
                                <td class="px-6 py-4">79.2%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- END TAB 4: ML Insights -->

        <!-- TAB 5: Browser Extension -->
        <div id="browser-extension-tab" class="tab-content">
            <div class="glass-card rounded-2xl p-8 mb-8">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">
                        <i class="fas fa-puzzle-piece text-green-600 mr-3"></i>Browser Extension
                    </h2>
                    <p class="text-gray-600">Real-time protection while browsing</p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Installation -->
                <div class="glass-card rounded-2xl p-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-download text-blue-600 mr-2"></i>Installation
                    </h3>
                    <div class="space-y-4">
                        <div class="flex items-start space-x-4">
                            <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0">1</div>
                            <div>
                                <div class="font-semibold text-gray-800">Download Extension</div>
                                <div class="text-sm text-gray-600">Get the extension from the repository</div>
                            </div>
                        </div>
                        <div class="flex items-start space-x-4">
                            <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0">2</div>
                            <div>
                                <div class="font-semibold text-gray-800">Open Extensions Page</div>
                                <div class="text-sm text-gray-600">chrome://extensions or about:addons</div>
                            </div>
                        </div>
                        <div class="flex items-start space-x-4">
                            <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0">3</div>
                            <div>
                                <div class="font-semibold text-gray-800">Enable Developer Mode</div>
                                <div class="text-sm text-gray-600">Toggle developer mode on</div>
                            </div>
                        </div>
                        <div class="flex items-start space-x-4">
                            <div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0">4</div>
                            <div>
                                <div class="font-semibold text-gray-800">Load Extension</div>
                                <div class="text-sm text-gray-600">Click "Load unpacked" and select folder</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Features -->
                <div class="glass-card rounded-2xl p-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-star text-yellow-500 mr-2"></i>Features
                    </h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-check-circle text-green-500"></i>
                            <span class="text-gray-700">Real-time URL scanning</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-check-circle text-green-500"></i>
                            <span class="text-gray-700">Instant phishing alerts</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-check-circle text-green-500"></i>
                            <span class="text-gray-700">Visual warnings on dangerous sites</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-check-circle text-green-500"></i>
                            <span class="text-gray-700">Privacy-preserving analysis</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-check-circle text-green-500"></i>
                            <span class="text-gray-700">Lightweight & fast</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-check-circle text-green-500"></i>
                            <span class="text-gray-700">Works offline (cached model)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Extension Stats -->
            <div class="glass-card rounded-2xl p-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-6">
                    <i class="fas fa-chart-line text-purple-600 mr-2"></i>Extension Statistics
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="text-center">
                        <div class="text-3xl font-bold text-blue-600 mb-2">0</div>
                        <div class="text-gray-600">Protected Visits</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-red-600 mb-2">0</div>
                        <div class="text-gray-600">Threats Blocked</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-green-600 mb-2">0</div>
                        <div class="text-gray-600">Safe Sites</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold text-purple-600 mb-2">100%</div>
                        <div class="text-gray-600">Protection Rate</div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END TAB 5: Browser Extension -->

        <!-- TAB 6: Monitoring -->
        <div id="monitoring-tab" class="tab-content">
            <div class="glass-card rounded-2xl p-8 mb-8">
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">
                        <i class="fas fa-chart-line text-blue-600 mr-3"></i>System Monitoring
                    </h2>
                    <p class="text-gray-600">Real-time performance & analytics</p>
                </div>
            </div>

            <!-- System Metrics -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="glass-card rounded-xl p-6 text-center">
                    <div id="total-scans" class="text-4xl font-bold text-blue-600 mb-2">0</div>
                    <div class="text-gray-600">Total Scans</div>
                </div>
                <div class="glass-card rounded-xl p-6 text-center">
                    <div id="today-scans" class="text-4xl font-bold text-green-600 mb-2">0</div>
                    <div class="text-gray-600">Today</div>
                </div>
                <div class="glass-card rounded-xl p-6 text-center">
                    <div id="threats-detected" class="text-4xl font-bold text-red-600 mb-2">0</div>
                    <div class="text-gray-600">Threats Detected</div>
                </div>
                <div class="glass-card rounded-xl p-6 text-center">
                    <div id="accuracy-rate" class="text-4xl font-bold text-purple-600 mb-2">85.9%</div>
                    <div class="text-gray-600">Model Accuracy</div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="glass-card rounded-2xl p-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-6">
                    <i class="fas fa-history text-blue-600 mr-2"></i>Recent Activity
                </h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Time</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Type</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Result</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Confidence</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Threat Level</th>
                            </tr>
                        </thead>
                        <tbody id="recent-activity" class="divide-y divide-gray-200">
                            <tr>
                                <td colspan="5" class="px-6 py-8 text-center text-gray-500">No recent activity</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- END TAB 6: Monitoring -->

    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div class="glass-card rounded-2xl p-8 text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <div class="text-xl font-semibold text-gray-800">Scanning...</div>
            <div class="text-gray-600 mt-2">This may take up to 10 seconds</div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        let currentScanType = 'comprehensive';

        // Monitoring stats
        let stats = {
            totalScans: 0,
            todayScans: 0,
            threatsDetected: 0,
            recentActivity: []
        };

        // Update monitoring stats
        function updateStats(scanType, result) {
            stats.totalScans++;
            stats.todayScans++;

            if (result.is_phishing || result.threat_level === 'critical' || result.threat_level === 'high') {
                stats.threatsDetected++;
            }

            // Add to recent activity
            const activity = {
                time: new Date().toLocaleTimeString(),
                type: scanType,
                result: result.is_phishing ? 'Phishing' : 'Legitimate',
                confidence: Math.round((result.confidence || 0) * 100) + '%',
                threatLevel: result.threat_level || 'low'
            };

            stats.recentActivity.unshift(activity);
            if (stats.recentActivity.length > 10) {
                stats.recentActivity.pop();
            }

            // Update UI
            document.getElementById('total-scans').textContent = stats.totalScans;
            document.getElementById('today-scans').textContent = stats.todayScans;
            document.getElementById('threats-detected').textContent = stats.threatsDetected;

            // Update recent activity table
            updateRecentActivity();
        }

        function updateRecentActivity() {
            const tbody = document.getElementById('recent-activity');
            if (stats.recentActivity.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="px-6 py-8 text-center text-gray-500">No recent activity</td></tr>';
                return;
            }

            tbody.innerHTML = stats.recentActivity.map(activity => {
                const threatColor = {
                    'critical': 'text-red-600',
                    'high': 'text-orange-600',
                    'medium': 'text-yellow-600',
                    'low': 'text-green-600'
                }[activity.threatLevel] || 'text-gray-600';

                return `
                    <tr>
                        <td class="px-6 py-4 text-sm text-gray-900">${activity.time}</td>
                        <td class="px-6 py-4 text-sm text-gray-900">${activity.type}</td>
                        <td class="px-6 py-4 text-sm font-medium ${activity.result === 'Phishing' ? 'text-red-600' : 'text-green-600'}">${activity.result}</td>
                        <td class="px-6 py-4 text-sm text-gray-900">${activity.confidence}</td>
                        <td class="px-6 py-4 text-sm ${threatColor} font-medium uppercase">${activity.threatLevel}</td>
                    </tr>
                `;
            }).join('');
        }

        // Tab Navigation
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');

            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Phishing Detection
        async function detectPhishing() {
            const url = document.getElementById('phishing-url').value.trim();
            if (!url) {
                alert('Please enter a URL');
                return;
            }

            showLoading(true);

            try {
                const response = await fetch(`${API_BASE}/predict/url`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url: url })
                });

                const data = await response.json();
                displayPhishingResults(data);
            } catch (error) {
                alert('Error: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        function displayPhishingResults(data) {
            const resultsDiv = document.getElementById('phishing-results');
            resultsDiv.classList.remove('hidden');

            const isPhishing = !!(
                data.is_phishing === true || data.is_phishing === 1 || data.is_phishing === 'true' ||
                data.prediction === 1 || data.prediction === 'phishing'
            );
            const confidence = (data.confidence || data.phishing_probability || 0) * 100;

            // Update verdict
            document.getElementById('phishing-verdict').textContent = isPhishing ? 'üé£' : '‚úÖ';
            document.getElementById('phishing-label').textContent = isPhishing ? 'Phishing Detected' : 'Legitimate Site';
            document.getElementById('phishing-label').className = isPhishing ? 'text-3xl font-bold mb-2 text-red-600' : 'text-3xl font-bold mb-2 text-green-600';
            document.getElementById('phishing-confidence').textContent = `Confidence: ${confidence.toFixed(1)}%`;

            // Update threat level
            const threatDiv = document.getElementById('phishing-threat');
            if (isPhishing) {
                if (confidence > 90) {
                    threatDiv.textContent = 'Critical Threat';
                    threatDiv.className = 'mt-4 px-4 py-2 rounded-lg inline-block bg-red-600 text-white font-bold';
                } else if (confidence > 70) {
                    threatDiv.textContent = 'High Threat';
                    threatDiv.className = 'mt-4 px-4 py-2 rounded-lg inline-block bg-orange-500 text-white font-bold';
                } else {
                    threatDiv.textContent = 'Medium Threat';
                    threatDiv.className = 'mt-4 px-4 py-2 rounded-lg inline-block bg-yellow-500 text-white font-bold';
                }
            } else {
                threatDiv.textContent = 'Safe';
                threatDiv.className = 'mt-4 px-4 py-2 rounded-lg inline-block bg-green-500 text-white font-bold';
            }

            // Show AI explanation if enabled
            if (document.getElementById('show-explanation').checked) {
                displayAIExplanation(data);
            }

            // Update monitoring stats
            updateStats('Phishing Detection', {
                is_phishing: isPhishing,
                confidence: confidence / 100,
                threat_level: isPhishing ? (confidence > 90 ? 'critical' : confidence > 70 ? 'high' : 'medium') : 'low'
            });

            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function displayAIExplanation(data) {
            const explanationDiv = document.getElementById('ai-explanation');

            let html = '<div class="space-y-2">';

            // Add key indicators
            if (data.features) {
                const features = data.features;
                const indicators = [];

                if (features.url_length > 75) {
                    indicators.push({ text: 'Unusually long URL', icon: '‚ö†Ô∏è', color: 'text-orange-600' });
                }
                if (features.num_special_chars > 10) {
                    indicators.push({ text: 'Many special characters', icon: '‚ö†Ô∏è', color: 'text-orange-600' });
                }
                if (features.has_ip_address) {
                    indicators.push({ text: 'Uses IP address instead of domain', icon: 'üö®', color: 'text-red-600' });
                }
                if (features.num_subdomains > 3) {
                    indicators.push({ text: 'Multiple subdomains', icon: '‚ö†Ô∏è', color: 'text-orange-600' });
                }

                if (indicators.length === 0) {
                    indicators.push({ text: 'No suspicious patterns detected', icon: '‚úÖ', color: 'text-green-600' });
                }

                indicators.forEach(ind => {
                    html += `
                        <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                            <span class="text-2xl">${ind.icon}</span>
                            <span class="${ind.color} font-medium">${ind.text}</span>
                        </div>
                    `;
                });
            } else {
                html += '<div class="text-gray-600">Detailed analysis not available</div>';
            }

            html += '</div>';
            explanationDiv.innerHTML = html;
        }

        // Email Analysis
        async function analyzeEmail() {
            const sender = document.getElementById('email-sender').value.trim();
            const subject = document.getElementById('email-subject').value.trim();
            const content = document.getElementById('email-content').value.trim();

            if (!content) {
                alert('Please enter email content');
                return;
            }

            showLoading(true);

            try {
                const response = await fetch(`${API_BASE}/predict/email`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email_content: content,
                        sender: sender,
                        subject: subject
                    })
                });

                const data = await response.json();
                displayEmailResults(data);
            } catch (error) {
                alert('Error: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        function displayEmailResults(data) {
            const resultsDiv = document.getElementById('email-results');
            resultsDiv.classList.remove('hidden');

            const isPhishing = !!(
                data.is_phishing === true || data.is_phishing === 1 || data.is_phishing === 'true' ||
                data.prediction === 1 || data.prediction === 'phishing'
            );
            const confidence = (data.confidence || data.phishing_probability || 0) * 100;

            document.getElementById('email-verdict').textContent = isPhishing ? '‚ö†Ô∏è' : '‚úÖ';
            document.getElementById('email-label').textContent = isPhishing ? 'Phishing Email' : 'Legitimate Email';
            document.getElementById('email-label').className = isPhishing ? 'text-3xl font-bold mb-2 text-red-600' : 'text-3xl font-bold mb-2 text-green-600';
            document.getElementById('email-confidence').textContent = `Confidence: ${confidence.toFixed(1)}%`;

            // Show risk factors
            const riskDiv = document.getElementById('email-risk-factors');
            let riskHtml = '';

            if (isPhishing) {
                // Prefer backend-provided risk factors if available
                const risks = (data.risk_factors && data.risk_factors.length > 0)
                    ? data.risk_factors
                    : [
                        'Suspicious sender address',
                        'Urgent language detected',
                        'Requests for personal information',
                        'Contains suspicious links'
                    ];

                risks.forEach(risk => {
                    riskHtml += `
                        <div class="flex items-center space-x-2 p-2 bg-red-50 rounded-lg">
                            <i class="fas fa-exclamation-triangle text-red-600"></i>
                            <span class="text-red-800">${risk}</span>
                        </div>
                    `;
                });
            } else {
                riskHtml = '<div class="text-green-600 font-medium">‚úÖ No significant risk factors detected</div>';
            }

            riskDiv.innerHTML = riskHtml;

            // Update monitoring stats
            updateStats('Email Analysis', {
                is_phishing: isPhishing,
                confidence: confidence / 100,
                threat_level: isPhishing ? (confidence > 90 ? 'critical' : confidence > 70 ? 'high' : 'medium') : 'low'
            });

            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function setScanType(type, event) {
            currentScanType = type;
            document.querySelectorAll('.scan-type-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-purple-600', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            if (event && event.target) {
                event.target.classList.add('active', 'bg-purple-600', 'text-white');
                event.target.classList.remove('bg-gray-200', 'text-gray-700');
            }
        }

        async function runComprehensiveScan() {
            const url = document.getElementById('scan-url').value.trim();
            if (!url) {
                alert('Please enter a URL');
                return;
            }

            showLoading(true);
            
            try {
                const endpoint = currentScanType === 'comprehensive' ? '/api/v1/scan/comprehensive' :
                                currentScanType === 'quick' ? '/api/v1/scan/quick' :
                                currentScanType === 'ssl' ? '/api/v1/scan/ssl' :
                                '/api/v1/predict';

                const response = await fetch(`${API_BASE}${endpoint}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url: url })
                });

                const data = await response.json();
                displayResults(data);
            } catch (error) {
                alert('Error: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        function displayResults(data) {
            document.getElementById('results-section').classList.remove('hidden');
            
            // Update overall score
            const score = data.overall_score || data.results?.score || 0;
            const grade = data.grade || getGrade(score);
            
            document.getElementById('overall-score').textContent = Math.round(score);
            document.getElementById('grade-text').textContent = `Grade: ${grade}`;
            document.getElementById('security-level').textContent = data.security_level || getSecurityLevel(score);
            
            // Update score circle color
            const scoreCircle = document.getElementById('score-circle');
            scoreCircle.className = `score-circle score-${grade[0]}`;
            
            // Update scanner scores if available
            if (data.scanner_scores) {
                updateScannerScore('ssl', data.scanner_scores.ssl || data.scanner_scores.SSL || 0);
                updateScannerScore('headers', data.scanner_scores.headers || data.scanner_scores.HEADERS || 0);
                updateScannerScore('vuln', data.scanner_scores.vulnerabilities || data.scanner_scores.VULNERABILITIES || 0);
                updateScannerScore('phishing', data.scanner_scores.phishing || data.scanner_scores.PHISHING || 0);
            }
            
            // Update issues and recommendations
            displayIssues(data.all_issues || data.issues || []);
            displayRecommendations(data.top_recommendations || data.recommendations || []);

            // Update monitoring stats
            updateStats('Security Scan', {
                is_phishing: score < 50,
                confidence: score / 100,
                threat_level: score >= 80 ? 'low' : score >= 60 ? 'medium' : score >= 40 ? 'high' : 'critical'
            });

            // Scroll to results
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        }

        function updateScannerScore(scanner, score) {
            document.getElementById(`${scanner}-score`).textContent = `${Math.round(score)}/100`;
            document.getElementById(`${scanner}-bar`).style.width = `${score}%`;
        }

        function displayIssues(issues) {
            const container = document.getElementById('issues-list');
            if (!issues || issues.length === 0) {
                container.innerHTML = '<div class="text-green-600"><i class="fas fa-check-circle mr-2"></i>No critical issues found!</div>';
                return;
            }
            
            container.innerHTML = issues.slice(0, 5).map(issue => `
                <div class="flex items-start space-x-3 p-3 bg-${getSeverityColor(issue.severity)}-50 rounded-lg">
                    <i class="fas fa-exclamation-circle text-${getSeverityColor(issue.severity)}-500 mt-1"></i>
                    <div class="flex-1">
                        <div class="font-semibold text-gray-800">${issue.message || issue.title}</div>
                        <div class="text-sm text-gray-600">${issue.severity || 'Medium'} severity</div>
                    </div>
                </div>
            `).join('');
        }

        function displayRecommendations(recommendations) {
            const container = document.getElementById('recommendations-list');
            if (!recommendations || recommendations.length === 0) {
                container.innerHTML = '<div class="text-gray-600">No recommendations at this time</div>';
                return;
            }
            
            container.innerHTML = recommendations.slice(0, 5).map(rec => `
                <div class="flex items-start space-x-3 p-3 bg-blue-50 rounded-lg">
                    <i class="fas fa-lightbulb text-blue-500 mt-1"></i>
                    <div class="flex-1">
                        <div class="font-semibold text-gray-800">${rec.recommendation || rec.message}</div>
                        ${rec.fix ? `<code class="text-xs bg-gray-800 text-white px-2 py-1 rounded mt-1 block">${rec.fix}</code>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function getSeverityColor(severity) {
            const colors = { critical: 'red', high: 'orange', medium: 'yellow', low: 'blue' };
            return colors[severity?.toLowerCase()] || 'gray';
        }

        function getGrade(score) {
            if (score >= 95) return 'A+';
            if (score >= 90) return 'A';
            if (score >= 85) return 'A-';
            if (score >= 80) return 'B+';
            if (score >= 75) return 'B';
            if (score >= 70) return 'B-';
            if (score >= 65) return 'C+';
            if (score >= 60) return 'C';
            if (score >= 55) return 'C-';
            if (score >= 50) return 'D';
            return 'F';
        }

        function getSecurityLevel(score) {
            if (score >= 90) return 'Excellent Security';
            if (score >= 75) return 'Good Security';
            if (score >= 60) return 'Fair Security';
            if (score >= 50) return 'Poor Security';
            return 'Critical Security Issues';
        }

        function showLoading(show) {
            document.getElementById('loading-overlay').classList.toggle('hidden', !show);
        }

        function testSample(url) {
            document.getElementById('scan-url').value = url;
            runComprehensiveScan();
        }

        // Initialize
        setScanType('comprehensive');
    </script>
</body>
</html>

